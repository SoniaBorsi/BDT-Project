import pandas as pd
import requests
import dask.dataframe as dd

def get_unique_reported_measure_names():
    url = "https://myhospitalsapi.aihw.gov.au/api/v1/datasets/"
    headers = {
        'Authorization': 'Bearer YOUR_ACCESS_TOKEN',
        'User-Agent': 'MyApp/1.0',
        'accept': 'text/csv'
    }

    response = requests.get(url, headers=headers)
    if response.status_code == 200:
        with open('datasets.csv', 'w') as f:
            f.write(response.text)

        datasets = dd.read_csv("datasets.csv")
        datasets['ReportedMeasureName'] = datasets['ReportedMeasureName'].str.strip()
        unique_reported_measure_names = datasets['ReportedMeasureName'].drop_duplicates().compute().tolist()

        return unique_reported_measure_names
    else:
        print("Failed to fetch data. Status code:", response.status_code)
        return None

unique_reported_measure_names = get_unique_reported_measure_names()

#df_unique_names = pd.DataFrame({'ReportedMeasureName': unique_reported_measure_names})
#df_unique_names.to_csv('unique_reported_measure_names.csv', index=False)
print(unique_reported_measure_names)


data = [['Breast cancer', 'Bowel cancer', 'Lung cancer', 'Resuscitation', 'Emergency', 'Urgent', 'Semi-Urgent', 'Non-Urgent', 'All patients', 'Subsequently admitted patients', 'Not subsequently admitted patients', 'Cardio-thoracic surgery', 'Ear, nose and throat surgery', 'General surgery', 'Gynaecology', 'Neurosurgery', 'Ophthalmology', 'Orthopaedic surgery', 'Plastic surgery', 'Urology', 'Vascular surgery', 'Other surgery', 'Cataract extraction (with or without intra-ocular lens insertion)', 'Cholecystectomy (open/laparoscopic)', 'Coronary artery bypass grafting', 'Cystoscopy', 'Haemorrhoidectomy', 'Hysterectomy (abdominal/vaginal/laparoscopic)', 'Inguinal herniotomy/herniorrhaphy', 'Myringoplasty/tympanoplasty', 'Myringotomy', 'Prostatectomy (transurethral or open)', 'Septoplasty', 'Tonsillectomy (with or without adenoidectomy)', 'Total hip replacement', 'Total knee replacement', 'Varicose veins treatment', 'Urgent elective surgery', 'Semi-urgent elective surgery', 'Non-urgent elective surgery', 'Appendix removal', 'Cellulitis', 'Chronic obstructive pulmonary disease (with complications)', 'Chronic obstructive pulmonary disease (without complications)', 'Gall bladder removal', 'Heart failure (with complications)', 'Heart failure (without complications)', 'Kidney and urinary tract infection (with complications)', 'Kidney and urinary tract infection (without complications)', 'Prostate removal', 'Caesarean delivery', 'Vaginal delivery', 'Reconstructive gynaecological surgery', 'Hysterectomy', 'All staphylococcus aureus', 'Medical (emergency)', 'Medical (non-emergency)', 'Childbirth', 'Mental health', 'Surgical (emergency)', 'Surgical (non-emergency)', 'Total', 'Methicillin-sensitive staphylococcus aureus', 'Methicillin-resistant staphylococcus aureus', 'Abdominal or thoracic aortic aneurysm - repair/replacement', 'Acromioplasty/arthroscopy shoulder/sub acromial decompression', 'Adenoidectomy', 'Amputation of limb', 'Anal fissure - repair of', 'Anterior cruciate ligament reconstruction', 'Arthrodesis', 'Arthroplasty - revision of', 'Arthroscopy', 'Axillary node dissection', "Bartholin's abscess drainage", "Bartholin's cyst - removal of", 'Bladder neck incision', 'Blepharoplasty', 'Branchial apparatus remnant - removal of', 'Breast lump - excision and/or biopsy', 'Breast prosthesis - removal of', 'Breast reconstruction', 'Breast reduction', 'Bunion (hallux valgus) - removal of', 'Carotid endarterectomy', 'Carpal tunnel release', 'Cerebral haematoma - evacuation of', 'Cervical discectomy and fusion', 'Chalazion - excision of', 'Chiari malformation decompression', 'Circumcision', 'Cleft lip and palate - repair of', 'Colectomy/anterior resection/large bowel resection', 'Common peroneal nerve release', 'Cone biopsy', 'Congenital cardiac defect/s - procedure for', 'Congenital pulmonary lesion - removal of', 'Corneal graft', 'Cranioplasty', 'Craniotomy', 'Curettage and evacuation of uterus', 'Cystectomy', 'Dacryocystorhinostomy', 'Dermoid cyst - removal of', 'Dialysis access surgery', 'Diathermy of wart/s', 'Discectomy', "Dupytren's contracture release", 'Ectropion - correction of', 'Endometrial ablation', 'Epididymal cyst - removal of', 'Ethmoidectomy', 'Examination of eye under anaesthesia', 'Exostosis - excision of', 'Female sterilisation', 'Femoro-popliteal bypass graft', 'Fracture non-union - treatment of', 'Functional endoscopic sinus surgery', 'Fundoplication', 'Ganglion - excision of', 'Hammer/claw/mallet toe - correction of', 'Heart valve replacement', 'Herniorrhaphy', 'Hydrocele - repair of', 'Hypospadias - repair of', 'Hysteroscopy, dilatation and curettage', 'Insertion of ventricular peritoneal shunt', 'Laminectomy', 'Laparoscopy', 'Large loop excision of the transformation zone cervix (LLETZ)', 'Laryngectomy', 'Lingual or maxillary frenulum surgery', 'Lithotripsy', 'Lobectomy/wedge resection/pneumonectomy', 'Lymphangioma - surgery for', 'Mastectomy', 'Mastoidectomy', 'Meatoplasty', 'Meniscectomy', 'Microlaryngoscopy', 'Muscle biopsy/temporal artery biopsy', 'Muscle or tendon length - change of', 'Myomectomy', 'Nasal cautery', 'Nasal polypectomy', 'Nasendoscopy', 'Nephrectomy', 'Nerve decompression', 'Nerve decompression of spinal cord', 'Orchidectomy', 'Orchidopexy', 'Osteotomy', 'Parathyroidectomy', 'Parotidectomy/submandibular gland - excision of', 'Pectus surgery', 'Pedicle screw fusion', 'Pharyngoplasty', 'Pharynx - excision of', 'Pilonidal sinus surgery', 'Pleurodesis', 'Posterior fossa decompression', 'Probing of naso-lacrimal duct', 'Procedure for strabismus (squint repair)', 'Prostate biopsy', 'Pterygium - excision of', 'Ptosis - repair of', 'Pyeloplasty/correction of ureteropelvic junction', 'Pyogenic granuloma - removal of', 'Radical neck dissection', 'Repair of obstructing hiatus hernia', 'Replacement of aortic aneurysm with bifurcation graft', 'Removal of intracranial lesion', 'Rhinoplasty', 'Rotator cuff - repair of', 'Salpingo-oophorectomy/oophorectomy/ovarian cystectomy', 'Scar revision', 'Shoulder joint replacement', 'Shoulder reconstruction', 'Skin lesion - excision of', 'Stapedectomy', 'Stone/s urinary tract - removal of', 'Stress incontinence surgery', 'Sub-mucosal resection', 'Tendon release', 'Tenotomy of hip', 'Thyroglossal remnant - removal of', 'Thyroidectomy/hemi-thyroidectomy', 'Toenail surgery', 'Trabeculectomy', 'Trigger finger/thumb release', 'Turbinectomy', 'Untethering of spinal cord', 'Ureteric - reimplantation', 'Ureteric stent - insertion of', 'Urethra - dilatation of', 'Vaginal repair - anterior/posterior', 'Vitrectomy (including buckling/cryotherapy)', 'Paediatric surgery', 'Other acute (emergency)', 'Other acute (non-emergency)', 'Rehabilitation', 'Palliative', 'Other subacute and non-acute', 'Acute admitted patients', 'Cost per NWAU Comparison to Peer Average', 'Obstetric services', 'Paediatric service', 'Psychiatric unit', 'Intensive care unit', 'Hospice care unit', 'Nursing home care unit', 'Geriatric assessment unit', 'Domiciliary care service', 'Alcohol and drug unit', 'Acute spinal cord injury unit', 'Coronary care unit', 'Cardiac surgery unit', 'Acute renal dialysis unit', 'Maintenance renal dialysis unit', 'Burns unit', 'Major plastic or reconstructive surgery unit', 'Oncology unit', 'Neonatal intensive care unit', 'In-vitro fertilisation unit', 'Epilepsy centre', 'Bone marrow transplantation unit', 'Renal transplantation unit', 'Heart transplantation unit', 'Liver transplantation unit', 'Pancreas transplantation unit', 'Clinical genetics unit', 'Sleep centre', 'Neurosurgical unit', 'Infectious diseases unit', 'AIDS unit', 'Diabetes unit', 'Rehabilitation unit', 'Myringotomy (without insertion of grommets)', 'Pressure equalising tubes (grommets) - insertion of', 'Neonatal surgery', 'All audited moments', 'Other procedure', 'Clinical pharmacology and/or toxicology service']]
dataframe = pd.DataFrame(data).T
dataf = dataframe.to_csv("all_measures.csv", header= True)
print(dataf)